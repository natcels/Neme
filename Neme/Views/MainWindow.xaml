<Window x:Class="Neme.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
 xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
 Style="{StaticResource MaterialDesignWindow}"
        xmlns:local ="clr-namespace:Neme.Views"
        Title="Neme" Height="600" Width="900">

    <Grid>

        <!-- Sidebar Navigation -->
        <DockPanel  Width="220" HorizontalAlignment="Left">

            <StackPanel DockPanel.Dock="Left" Width="200"
                        VerticalAlignment="Stretch">
                <Expander Header="Contacts" IsExpanded="True" Margin="5,10">
                    <ListBox ItemsSource="{Binding Peers}"
                         SelectedItem="{Binding SelectedPeer, Mode=TwoWay}"
                         Background="Transparent"
                         Foreground="White"
                         MaxHeight="350"
                         Margin="10">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal" Margin="5">
                                    <Border Width="40" Height="40" CornerRadius="20" BorderThickness="1" BorderBrush="Gray">
                                        <Image Source="{Binding Avatar}" Width="45" Height="45" Margin="0" />
                                    </Border>

                                    <StackPanel Margin="5">
                                        <TextBlock Text="{Binding Name}" FontWeight="Bold" Foreground="Navy"/>
                                        <TextBlock Text="{Binding Status}" FontSize="12" Foreground="Gray" />
                                    </StackPanel>
                                </StackPanel>
                            </DataTemplate>

                        </ListBox.ItemTemplate>
                    </ListBox>
                </Expander>

                <!-- Contacts List -->

                <Expander Header="Groups" IsExpanded="True" Margin="5,10">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal">

                            <Button x:Name="RenameGroupButton"   
                                    Margin="5" Command="{Binding RenameGroupCommand}"
                                    Width="25" Height="25"
                                     Style="{StaticResource MaterialDesignFloatingActionButton}">
                                <materialDesign:PackIcon Kind="Pen" Width="18" Height="18" ToolTip="rename Group"/>
                            </Button>
                            <Button  Command="{Binding CreateGroupCommand}" 
                                     Margin="5" ToolTip="Create New Group"
                                      Style="{StaticResource MaterialDesignFloatingActionButton}"
                                     Width="25" Height="25">
                                <materialDesign:PackIcon Kind="Add" Width="18" Height="18"/>
                            </Button>
                        </StackPanel>
                        <ListView ItemsSource="{Binding Groups}" SelectedItem="{Binding SelectedGroup}" Name="GroupListBox">
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="{Binding GroupName}" />
                                        <Button Width="30" Height="30" Background="Gray" Foreground="White" ToolTip="Add Peer to THIS group">
                                            <materialDesign:PackIcon Kind="Add" Width="20" Height="30"/>
                                        </Button>
                                    </StackPanel>

                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </StackPanel>
                </Expander>

            </StackPanel>
        </DockPanel>
        <!-- Main Content -->
        <Grid Margin="250,0,10,0">
            <TabControl>
                <!-- Chat Tab -->
                <TabItem Header="Chats">
                    <Grid>
                        <TextBlock Text="Select a contact to start chatting"
                   FontSize="16" Foreground="Gray"
                   HorizontalAlignment="Center" VerticalAlignment="Center"
                                   Visibility="{Binding isPeerSelected, 
                            Converter={StaticResource BooleanToVisibilityConverter}}"
                                   />
                        <!-- ChatView appears when a peer is selected -->
                        <local:ChatView
                            HorizontalAlignment="Center" 
                            Margin="0,311,0,0" 
                            VerticalAlignment="Top" Width="620"
                            Visibility="{Binding isPeerSelected, 
                            Converter={StaticResource InvertedBooleanToVisibilityConverter}}"
                            />
                    </Grid>
                </TabItem>
                <!-- Video Calls -->
                <TabItem Header="Video Calls">
                    <Grid>
                        <Button Command="{Binding StartVoiceCallCommand}" 
                                Width="200" Height="50" 
                                Background="#6200EA" Foreground="White" 
                                Style="{StaticResource MaterialDesignRaisedButton}" Margin="60,240,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="Call" Width="24" Height="24" Margin="0,0,10,0"/>
                                <TextBlock Text="Voice Call"/>
                            </StackPanel>
                        </Button>

                        <Button Command="{Binding StartVideoCallCommand}"
                                Width="200" Height="50"
                                Background="#6200EA" Foreground="White"
                                Style="{StaticResource MaterialDesignRaisedButton}" Margin="367,240,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="Video" Width="24" Height="24" Margin="0,0,10,0"/>
                                <TextBlock Text="Video Call"/>
                            </StackPanel>
                        </Button>

                    </Grid>
                </TabItem>
                <!-- Settings -->
                <TabItem Header="Settings">
                    <Frame Source="SettingsWindow.xaml"/>
                </TabItem>
            </TabControl>
        </Grid>
    </Grid>
</Window>
