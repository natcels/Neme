<Window x:Class="cleddmessenger.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Cledd Messenger" Height="600" Width="900">
    <Window.Resources>
        <Style x:Key="CircularButtonStyle" TargetType="Button">
            <Setter Property="Width" Value="50"/>
            <Setter Property="Height" Value="50"/>
            <Setter Property="Background" Value="#007ACC"/>
            <Setter Property="BorderBrush" Value="#007ACC"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Grid>
                            <Ellipse Fill="{TemplateBinding Background}" 
                                     Stroke="{TemplateBinding BorderBrush}" 
                                     StrokeThickness="{TemplateBinding BorderThickness}"/>
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>



    <Grid>
        <!-- Define Columns -->
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="250" />
            <!-- Sidebar -->
            <ColumnDefinition Width="*" />
            <!-- Main Content -->
        </Grid.ColumnDefinitions>

        <!-- Sidebar -->
        <StackPanel Background="#f5f5f5" Grid.Column="0">
            <!-- User Profile Section -->
            <StackPanel Orientation="Horizontal"  Background="#052C9B">
                <Image Source="/Views/user-avatar.jpg" Width="50" Height="50" Margin="5" />
                <StackPanel>
                    <TextBlock Text="Your Name" FontWeight="Bold" Foreground="White" />
                    <TextBlock Text="Online" Foreground="LightGreen" VerticalAlignment="Center" />
                </StackPanel>
                <Button  Width="25" Height="25" Margin="70,5,5,5" 
                        Command="{Binding OpenSettingsCommand}" 
                         Style="{StaticResource CircularButtonStyle}"
                        ToolTip="Settings" >
                    <materialDesign:PackIcon Kind="Settings" Width="18" Height="18" Foreground="White"/>
                </Button>
            </StackPanel>

            <!-- Peers List -->
            <TextBlock Text="Peers" FontSize="14" FontWeight="Bold" Margin="10,10,0,5" />
            <ListView ItemsSource="{Binding Peers}" SelectedItem="{Binding SelectedPeer}" MaxHeight="350">
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal" Margin="5">
                            <Image Source="{Binding Avatar}" Width="40" Height="40" Margin="5" />
                            <StackPanel>
                                <TextBlock Text="{Binding Name}" FontWeight="Bold" />
                                <TextBlock Text="{Binding Status}" FontSize="12" Foreground="Gray" />
                            </StackPanel>
                        </StackPanel>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>

            <!-- Groups Section -->
            <Expander Header="Groups" IsExpanded="True" Margin="5,10">
                <StackPanel>
                    <StackPanel Orientation="Horizontal">

                        <Button x:Name="RenameGroupButton"   Margin="5" Command="{Binding RenameGroupCommand}" >
                            <materialDesign:PackIcon Kind="Pen" Width="18" Height="18" ToolTip="rename Group"/>
                        </Button>
                        <Button  Command="{Binding CreateGroupCommand}" Margin="5" ToolTip="Create New Group">
                            <materialDesign:PackIcon Kind="Add" Width="18" Height="18"/>
                        </Button>
                    </StackPanel>
                    <ListView ItemsSource="{Binding Groups}" SelectedItem="{Binding SelectedGroup}" Name="GroupListBox">
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding GroupName}" />
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </StackPanel>
            </Expander>
        </StackPanel>

        <!-- Main Content Area -->
        <Grid Grid.Column="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
                <!-- Chat Display -->
                <RowDefinition Height="Auto" />
                <!-- Message Input -->
            </Grid.RowDefinitions>
            <ListBox Name="ChatMessagesList" Margin="10" ItemsSource="{Binding FilteredMessages}" Grid.Row="0">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Vertical" Margin="5">
                            <!-- Displaying Sender Name and Message -->
                            <TextBlock Text="{Binding SenderName}" FontWeight="Bold" />
                            <TextBlock Text="{Binding Timestamp}" FontStyle="Italic" FontSize="10" />

                            <!-- Display Text Messages -->
                            <TextBlock Text="{Binding Content}" TextWrapping="Wrap" Margin="5" />

                            <!-- Display Files -->
                            <StackPanel x:Name="FileMessagePanel" Orientation="Horizontal">
                                <Image x:Name="FileImage" Width="50" Height="50" Visibility="Collapsed"/>
                                <TextBlock x:Name="FileText" Visibility="Collapsed" Text="File: {Binding FileName}" Margin="5" />
                                <Button x:Name="OpenFileButton" Content="Open" Visibility="Collapsed"  />
                            </StackPanel>

                            <!-- Display Image Preview -->
                            <Image x:Name="ImagePreview" Width="200" Height="200" Visibility="Collapsed" Margin="5"/>
                        </StackPanel>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>


            <!-- Chat Display 
            Click="OpenFileButton_Click"
            
            <ListView ItemsSource="{Binding FilteredMessages}" Grid.Row="0">
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Margin="10">
                            <TextBlock Text="{Binding SenderName}" FontWeight="Bold" />
                            <TextBlock Text="{Binding Content}" TextWrapping="Wrap" />
                        </StackPanel>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>-->

            <!-- Input Section -->

            <Border Background="#FFDDDDDD" 
                    BorderThickness="1" CornerRadius="10" 
                    HorizontalAlignment="Stretch"  
                    Margin="5"
                    Grid.Row="1"
                   >
                <StackPanel Orientation="Vertical"  Margin="10,10,10,5" Height="auto" VerticalAlignment="Bottom">
                    <TextBox Text="{Binding CurrentMessage}"  MinHeight="30" MaxHeight="150" 
                         AcceptsReturn="True"
                         TextWrapping="Wrap" 
                             BorderBrush="{x:Null}"
                           VerticalScrollBarVisibility="Auto" VerticalAlignment="Bottom" />

                    <Border CornerRadius="20" Height="40" Background="#FF969696" BorderBrush="Black" HorizontalAlignment="Center" Margin="0,10,0,0" >
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Height="40">

                            <Button x:Name="btn_Attachment" 
                                    Command="{Binding UploadFileCommand}" 
                                    Style="{StaticResource CircularButtonStyle}"
                                    Width="35" Height="35" Margin="0,0,150,0" 
                                    ToolTip="Attach File" HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                   
                                    >
                                <materialDesign:PackIcon Kind="Paperclip" Width="18" Height="18" Foreground="White" />

                            </Button>

                            <Button Command="{Binding SendMessageCommand}" Style="{StaticResource CircularButtonStyle}" Margin="150,0,0,0" Width="35" Height="35" 
                                     HorizontalAlignment="Center" 
                                     ToolTip="Send Message"
                                     VerticalAlignment="Center"
                                    >

                                <materialDesign:PackIcon Kind="Send" Width="18" Height="18" Foreground="White" />
                            </Button>



                        </StackPanel>
                    </Border>

                </StackPanel>

            </Border>


        </Grid>
    </Grid>
</Window>
